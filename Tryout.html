<!DOCTYPE html>
<!--open -b com.google.chrome --args --allow-file-access-from-files-->
<html>
    <head>
        <script type="text/javascript" src="d3.min.js"></script>
    </head>
    <style>
    </style>
    <body>
        <script>

            var fixedData = [];
            var countries = [];    
            var data1 = [];    
            var perc = [];    
            
            d3.tsv("tec00114.tsv", function (data) {
                for (var i=0;i<data.length;i++) {
                    if(data[i]["2001 "] != ": " && data[i]["2012 "] != ": "){
                        data1.push((data[i]));    
                    };
                    data[i]["2001 "] = parseFloat(data[i]["2001 "]);
                    data[i]["2012 "] = parseFloat(data[i]["2012 "]);
                };
                    
                fixedData = data1.map(function(d){
                    return [ +d["indic_na,aggreg95,geo\time"], +d["2001 "], +d["2012 "] ];
                });
                
                for(var i=0;i<data1.length;i++){
                    var keys = Object.keys(data[i]);
                    countries.push(data1[i][keys[0]]);
                };
                
                for(var i=0;i<fixedData.length;i++){
                    if(isNaN(fixedData[i][0])){
                        fixedData[i][0] = countries[i].substring(19,23);
                    };
                };
                
                for(var i=0;i<fixedData.length;i++){
                    perc.push([]);
                    perc[i].push(fixedData[i][0]);
                    perc[i].push((fixedData[i][2] - fixedData[i][1])/fixedData[i][1]*100);
                };
				console.log(perc);
            })  
			var fixedData2 = [];
            var countries2 = [];    
            var data2 = [];    
            var perc2 = [];    
            
            d3.tsv("tec00104.tsv", function (data) {
                for (var i=0;i<data.length;i++) {
                    if(data[i]["2002 "] != ": " && data[i]["2012 "] != ": "){
                        data2.push(data[i]); 
                    };
                };
			    fixedData2 = data2.map(function(d){
                    return [ +d["unit,sector,indic_na,geo\time"], +d["2002 "], +d["2012 "] ];
                });
                
                for(var i=0;i<data2.length;i++){
                    var keys = Object.keys(data[i]);
                    countries2.push(data2[i][keys[0]]);
                };
                
                for(var i=0;i<fixedData2.length;i++){
                    if(isNaN(fixedData2[i][0])){
                        fixedData2[i][0] = countries2[i].substring(23,27);
                    };
                };
                
                for(var i=0;i<fixedData2.length;i++){
                    perc2.push([]);
                    perc2[i].push(fixedData2[i][0]);
                    perc2[i].push((fixedData2[i][2] - fixedData2[i][1])/fixedData2[i][1]*100);
                };
				console.log(perc2);
            })    
                    
        </script>
    </body>
</html>

